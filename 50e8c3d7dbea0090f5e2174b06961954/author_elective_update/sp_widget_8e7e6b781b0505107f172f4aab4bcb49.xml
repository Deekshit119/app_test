<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="DELETE">
        <category>custom</category>
        <client_script><![CDATA[function(spModal, $scope, $rootScope, $location, $timeout, spUtil, spAriaFocusManager, $uibModalStack) {
  var c = this;
	
	$scope.expline_sysid = c.data.expline_sysid;
	$scope.valCodeloga = c.data.codeloga[0].code;
	
	var year= c.data.date.substr(6, 4);
	var month= c.data.date.substr(3, 2);
	var day= c.data.date.substr(0, 2);
	$scope.expDate = new Date(year,month-1,day);
	
	$scope.location_from = {
	displayValue: c.data.items[0].expline_location,
	value: c.data.LocationFromId,
	name: 'location_from'
	};
	
	$scope.location_to = {
	displayValue: c.data.items[0].expline_travelkm,
	value: c.data.LocationToId,
	name: 'location_to'
	};
	
	$scope.Rubric = {
	displayValue: c.data.items[0].expline_rubric,
	value: c.data.RubricId,
	name: 'Rubric'
	};
	
	$scope.expOpenBy = '' || c.data.items[0].expsheet_opened_by;
	$scope.expReqFor = '' || c.data.items[0].expsheet_requested_for;
	$scope.expContract = '' || c.data.items[0].expsheet_contract;
	$scope.expDesc = '' || c.data.items[0].expsheet_short_description;
	$scope.expAmount = parseFloat(c.data.items[1].expline_requested_amount).toFixed(2); //c.data.items[0].expline_requested_amount;
		
	if(''+c.data.items[0].expline_other_location_to == '') {
		$scope.expOtherLoc = '' || c.data.items[0].expline_location;
		$scope.expOtherLocTo = '' || c.data.items[0].expline_other_location;
	}
	else {
		$scope.expOtherLoc = '' || c.data.items[0].expline_other_location;
		$scope.expOtherLocTo = '' || c.data.items[0].expline_other_location_to;
	}
	
	$scope.CategDivers = '';
	if(c.data.items[0].expline_miscellaneous_account_code) {
		$scope.CategDivers = c.data.items[0].expline_miscellaneous_account_code;
	}
	c.data.CategDiversNbChar = $scope.CategDivers.trim().length;

	$scope.buttonClosewindow = function () {
				  $uibModalStack.dismissAll();
        };
}]]></client_script>
        <controller_as>c</controller_as>
        <css>.widget-data-table .clearfix{ 
	display: none; 
} 

.pointer {
    cursor: default;
}

.v5001b062d7101200b0b044580e6103eb .sp-list-cell {
    white-space: pre-wrap;
}

.user-profile-tabs { 
  height: 60px; 
   
  .widget-header { 
    padding-bottom: 10px; 
    font-weight: normal; 
    color : $brand-primary;
  } 
 
  .no-padding { 
    padding-left : 0px; 
    text-align: center; 
    cursor: pointer; 
 
  } 
 
  .tab-row { 
    margin-top: 15px; 
  } 
} 
 
.widget-tabs { 
  border-bottom: 1px solid $csm-border-color;
  margin-bottom: 15px; 
} 
.widget-tabs { 
  border-bottom: 1px solid $csm-border-color;
} 

.tr-top {
  border-top: 1px solid #ddd;
}

.th-exp-title {
    color: #b92d33;
    display: inline-block;
}

.td_img {
		width: 20px;
  	height: 20px;
  	display: inline-block;
}

.thead {
    border-bottom: 1px solid #ddd;
    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-top: 1px solid #ddd;
}

h4 { 
  padding-left: 0px; 
  margin-bottom: 0px; 
} 
 
h4.selected-tab { 
  /*border-bottom: 2px solid #278EFC; */
  border-bottom: 2px solid $brand-primary; 
  color: $link-color;
} 

.btn_expense {
    display: inline-block;
    margin-bottom: 0;
    font-weight: normal;
    text-align: center;
    vertical-align: middle;
    touch-action: manipulation;
    cursor: pointer;
    background-image: none;
    border: 1px solid transparent;
    white-space: nowrap;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.42857;
    border-radius: 4px;
}

.pull-right_expense {
    float: right;
}

.btn_expense-primary_save {
    color: #ffffff;
    background-color: #5bb914;
    border-color: #508c23;
}
 
.btn_expense-primary_close {
    color: #ffffff;
    background-color: #b92d33;
    border-color: #a4282d;
}
 
.profile-tabs { 
  clear: both; 
  padding-bottom: 15px; 
} 

.td-alignmiddle {
	vertical-align:middle;
}
  
.panel-heading{
 background-color :  $panel-primary; 
}
.expense-panel-primary {
    border-color: #b92d33;
    width: 1585px;
}

.btn-padding-expense{
  padding-right: 15px; 
}

span.panel-title{
 color: $panel-default-heading-bg;
 /*vertical-align: sub;
  vertical-align: -webkit-baseline-middle;*/
}

.panel-heading &gt; .dropdown .dropdown-toggle {
   color: $panel-primary-text;
   /*padding-bottom: 0px;
   vertical-align: bottom;*/
}

</css>
        <data_table>sp_instance</data_table>
        <demo_data>{"options": {
	"sys_id": -1,
		"table": "incident"
	}
}</demo_data>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>hvs_expense_ticket_details</id>
        <internal>false</internal>
        <link><![CDATA[function(scope, elm) {
	// Set the focus back on the input for IE11
	scope.setFocus = function() {
		var input = $(elm[0]).find('textarea#post-input');
		if (input[0])
			input[0].focus();
	}
}]]></link>
        <name>HVS Expense Ticket Details</name>
        <option_schema>[{"hint":"Placeholder text shows selected journal field","name":"use_dynamic_placeholder","section":"Behavior","label":"Use dynamic placeholder","type":"boolean"},{"hint":"Message to show when record has no readable journal field","name":"no_readable_journal_field_message","default_value":"","section":"Presentation","label":"No readable journal field message","type":"string"},{"hint":"Enter key behavior is specified by system property (glide.service_portal.comment.enter_adds_newline) unless overridden here","name":"enter_key_behavior","section":"Behavior","default_value":"System property","label":"Enter key behavior","type":"choice","choices":[{"label":"System property","value":"System property"},{"label":"Submit","value":"Submit"},{"label":"New line","value":"New line"}]}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
 // code for internal testing within Editor
 // input=[];
 // input.sys_id=['f0e523d01b632c107f172f4aab4bcb0b'];
 // end of code for internal testing
	
	var isApproverUser = false;
	var isApproverDelegate = false;
	var sUserDelegate = '';
	var user = new GlideRecord('sys_user');
	if(user.get(gs.getUserID())){
		isApproverUser = user.u_expense_approver;
	}
	
	var userDelegate = new GlideRecord('sys_user_delegate');
	userDelegate.addEncodedQuery("delegate="+gs.getUserID()+"^u_expense_approval=true");
	userDelegate.setLimit(1);
	userDelegate.query();
	while (userDelegate.next()) {
		isApproverDelegate = userDelegate.u_expense_approval;
		sUserDelegate =  userDelegate.user;
	}
	
	if(input) {
		if(input.sys_id) {
			data.valCodeloga='';
			data.items = getCatalogItems();
			data.expline_sysid = input.sys_id;
		}
	}

	var filterRubric = '';
	
	function getCatalogItems() {
		var sc = new GlideRecord('x_hdvi2_expense_view');
		sc.addQuery('expline_sys_id',input.sys_id);
		sc.query();
		var results = [];
		while (sc.next()) {
			if (!$sp.canReadRecord(sc) && !isApproverDelegate && !isApproverUser)
				continue;

			var ticketConversationOptions = {};
			ticketConversationOptions.sys_id = sc.getValue('expline_expense');
			ticketConversationOptions.table  = 'x_hdvi2_expense_sheet';
			ticketConversationOptions.record_id = sc.getValue('expline_expense');
			ticketConversationOptions.record_table  = 'x_hdvi2_expense_sheet';
			ticketConversationOptions.readonly = ''+input.read_only;
			ticketConversationOptions.record_only = ''+input.read_only;
			data.Attachment = $sp.getWidget('widget-expense-ticket-attachments', ticketConversationOptions);

			var options = {
				filter : 'expense='+sc.expsheet_sys_id+'^statusIN2,3,4^ORstatusIN1'
			};	
			
			data.dataTableWidget = $sp.getWidget('hvs-expense-widget-data-table', options);
			
			var item = {};
			// Récuperation des champs à afficher
			$sp.getRecordDisplayValues(item, sc, 'expline_sys_id,expsheet_contract,expsheet_number,expline_date_expense,expsheet_short_description,expsheet_opened_by,expsheet_requested_for,expsheet_contract,expline_rubric,expsheet_category,expline_status,expline_currency,expline_location,expline_travelkm,expline_other_location,expline_other_location_to,expsheet_category,expline_miscellaneous_account_code,expsheet_source,expline_one_way');
			results.push(item);
			// Récuperation des champs à afficher avec montant et valeur demandé
			$sp.getRecordValues(item, sc, 'expline_requested_amount,expline_requested_value');
			results.push(item);

			data.date=sc.getDisplayValue('expline_date_expense');
			data.expline_requested_value = parseFloat(sc.getValue('expline_requested_value'));
			data.expline_requested_amount = parseFloat(sc.getValue('expline_requested_amount'));
			
			// Récupération de l'expense type catégorie
			var sFilterRubric = sc.getValue('expsheet_category');
			data.CategRubric=sFilterRubric.charAt(0).toUpperCase() + sFilterRubric.slice(1);
			filterRubric ='category=topic^active=true^type='+sFilterRubric.charAt(0).toUpperCase() + sFilterRubric.slice(1)+'^contract_type=';
			data.areaRows = 2;
			if(data.CategRubric=='Training'){
				results[0].expsheet_short_description += "\n" + results[0].expsheet_source;
				data.areaRows = 4;
			}
			data.LocationFromId = ''||sc.getValue('expline_location');
			data.LocationToId = ''||sc.getValue('expline_travelkm');
			data.RubricId = ''||sc.getValue('expline_rubric');
		}

		data.codeloga = [];
		var scCodeLoga = new GlideRecord('x_hdvi2_expense_loga_data');
		scCodeLoga.addQuery('sys_id',data.RubricId);
		scCodeLoga.query();
		while (scCodeLoga.next()) {
			var objCode = {};
			data.valCodeloga=scCodeLoga.code;
			$sp.getRecordDisplayValues(objCode, scCodeLoga, 'code,label,sys_id');
			data.codeloga.push(objCode);
		}
		
		return results;
	}
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2022-01-12 14:03:11</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>8e7e6b781b0505107f172f4aab4bcb49</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>HVS Expense Ticket Details</sys_name>
        <sys_package display_value="HVS Expense Management" source="x_hdvi2_expense">50e8c3d7dbea0090f5e2174b06961954</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="HVS Expense Management">50e8c3d7dbea0090f5e2174b06961954</sys_scope>
        <sys_update_name>sp_widget_8e7e6b781b0505107f172f4aab4bcb49</sys_update_name>
        <sys_updated_by>h40009222</sys_updated_by>
        <sys_updated_on>2022-01-12 14:27:53</sys_updated_on>
        <template><![CDATA[ <div ng-if="data.uId != 'user_id8a21e682dbb6ff80bbe25c88f4961984'">
 		<sp-widget widget="c.data.Attachment" />
 </div>
<div class="panel panel-primary" >

 <div class="panel-heading">${expense.label.view_detail} : <b>{{c.data.items[0].expsheet_number}}</b></div>
 <div class="panel-primary">

   <table class="table table-striped table-responsive">
     <tr>
       <td class="thead text-nowrap">
      	<label>${expense.label.opened_by} :</label>
     		<input readonly class="form-control" ng-change="SetChangeTrue()" ng-model="expOpenBy" value="{{c.data.items[0].expsheet_expOpenBy}}" type="text">
       </td>
      <td class="thead text-nowrap">
     		<label for="expReqFor">${expense.label.requested_for} :</label>
     		<input readonly class="form-control" ng-change="SetChangeTrue()" ng-model="expReqFor" value="{{c.data.items[0].expsheet_requested_for}}" type="text">
       </td>
     </tr>
     <tr>
       <td class="thead text-nowrap" colspan="2">
      	<label for="expContract">${expense.label.Contract} :</label>
     		<input readonly class="form-control" ng-change="SetChangeTrue()" ng-model="expContract" value="{{c.data.items[0].expsheet_contract}}" type="text">
       </td>
     </tr>
     <tr>
       <td class="thead text-nowrap" colspan="2">
         <label for="expDesc">${expense.label.short_description} :</label>
         <textarea readonly rows="{{c.data.areaRows}}" ng-bind-html="expDesc" id="expDesc" class="form-control" ng-change="SetChangeTrue()" ng-model="expDesc" type="text"></textarea>
       </td>
     </tr>
     <tr  ng-if="data.CategRubric == 'Standard'">
       <td class="thead text-nowrap" colspan="2">
        <label for="expDate">${expense.label.date} : </label>
     		<input readonly class="form-control" placeholder="dd-MM-yyyy" ng-change="SetChangeTrue()" ng-model="expDate" Value="{{data.date}}" id="expDate" type="date"> 
       </td>
     </tr>
     <tr>
       <td ng-if="data.CategRubric == 'Standard'" class="thead text-nowrap" colspan=2>
         <div ng-if="data.CategRubric == 'Standard'">
           <label for="Rubric">${expense.label.LogaRubric} :</label>
           <sn-record-picker readonly field="Rubric" table="'x_hdvi2_expense_loga_data'" display-field="'label'" value-field="'sys_id'" search-fields="'label'" page-size="" default-query="'{{c.data.FilterRubric}}'"></sn-record-picker>
         </div>
         <!-- display selected category if Loga Rubric = Divers -->
         <div ng-if="data.items[0].expline_miscellaneous_account_code != ''  && data.CategDiversNbChar > 1">
           <!--label for="CategDivers">${expense.label.CategoryDivers} :</label-->
           <input readonly class="form-control" ng-model="CategDivers" Value="{{c.data.items[0].expsheet_short_description}}" id="CategDivers" type="text">
         </div>
         <div ng-if="data.codeloga[0].code!='79C' || data.codeloga[0].code!='809'">
           <label style="padding-top:8px;" id="labelReqAmount" for="expReqAmount">${expense.label.RequestedAmount} :</label>
           <input readonly id="expReqAmount" class="form-control" ng-change="SetChangeTrue()" ng-model="expAmount" value="{{c.data.items[1].expline_requested_amount}}" type="text">
         </div>
         <div ng-if="data.codeloga[0].code=='79C' && data.codeloga[0].sys_id=='fbc37b13dbee0090f5e2174b06961948'">
           <label style="padding-top:8px;" id="labelReqValue" for="expReqValue">${expense.label.RequestedValue} :</label>
           <input id="expReqValue" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number">
           <label style="padding-top:8px;" id="labelLocFrom" for="location_from">${expense.label.LocationFrom} :</label>
           <sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" ></sn-record-picker>
           <label style="padding-top:8px;" id="labelLocTo" for="location_to">${expense.label.LocationTo} :</label>
           <sn-record-picker readonly id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" ></sn-record-picker>
      		 <label style="padding-top:8px;display:none;" id="labelOtherLoc" for="expOtherLoc">${expense.label.OtherLocation} :</label>
     			 <input style="display:none;" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
         </div> 
         <div ng-if="data.codeloga[0].code=='809' && data.codeloga[0].sys_id=='9805f444db44149009b962a916961908'">
           <label style="padding-top:8px;" id="labelReqValue" for="expReqValue">${expense.label.RequestedValue} :</label>
           <input id="expReqValue" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number">
           <label style="padding-top:8px;" id="labelLocFrom" for="location_from">${expense.label.LocationFrom} :</label>
           <sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" ></sn-record-picker>
           <label style="padding-top:8px;" id="labelLocTo" for="location_to">${expense.label.LocationTo} :</label>
           <sn-record-picker readonly id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" ></sn-record-picker>
      		 <label style="padding-top:8px;display:none;" id="labelOtherLoc" for="expOtherLoc">${expense.label.OtherLocation} :</label>
     			 <input style="display:none;" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
         </div>  

         <div ng-if="data.codeloga[0].code=='79C' && data.codeloga[0].sys_id=='edc49704dbd3c050f5e2174b06961901' && data.items[0].expline_other_location!=''">
           <label style="padding-top:8px;" id="labelReqValue" for="expReqValue">${expense.label.RequestedValue} :</label>
           <input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number">
           <!--label style="padding-top:8px;" id="labelLocFrom" for="location_from">${expense.label.LocationFrom} :</label>
           <sn-record-picker id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" ></sn-record-picker>
						-->
      		 <label style="padding-top:8px;" id="labelOtherLoc" for="expOtherLoc">${expense.label.LocationFrom} :</label>
     			 <input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
           <label style="padding-top:8px;" id="labelOtherLocTo" for="expOtherLocTo">${expense.label.LocationTo} :</label>
     			 <input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLocTo" ng-model="expOtherLocTo" value="{{c.data.items[0].other_location_to}}" type="text">
           <!--sn-record-picker style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" ></sn-record-picker>
					-->
         </div>  
         <div ng-if="data.codeloga[0].code=='809' && data.codeloga[0].sys_id=='e8e4b084db44149009b962a916961906' && data.items[0].expline_other_location!=''">
           <label style="padding-top:8px;" id="labelReqValue" for="expReqValue">${expense.label.RequestedValue} :</label>
           <input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number">
           <!--label style="padding-top:8px;" id="labelLocFrom" for="location_from">${expense.label.LocationFrom} :</label>
           <sn-record-picker id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" ></sn-record-picker>
						-->
      		 <label style="padding-top:8px;" id="labelOtherLoc" for="expOtherLoc">${expense.label.LocationFrom} :</label>
     			 <input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
           <label style="padding-top:8px;" id="labelOtherLocTo" for="expOtherLocTo">${expense.label.LocationTo} :</label>
     			 <input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLocTo" ng-model="expOtherLocTo" value="{{c.data.items[0].other_location_to}}" type="text">
           <!--sn-record-picker style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" ></sn-record-picker>
					-->
         </div>  
                
         <div ng-if="data.codeloga[0].code=='79C' && data.codeloga[0].sys_id=='edc49704dbd3c050f5e2174b06961901' && data.items[0].expline_other_location==''">
           <label style="padding-top:8px;" id="labelReqValue" for="expReqValue">${expense.label.RequestedValue} :</label>
           <input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number">
           <label style="padding-top:8px;" id="labelLocFrom" for="location_from">${expense.label.LocationFrom} :</label>
           <sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" ></sn-record-picker>
           <label style="padding-top:8px;display:none;" id="labelLocTo" for="location_to">${expense.label.LocationTo} :</label>
           <sn-record-picker readonly style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" ></sn-record-picker>
      		 <label style="padding-top:8px;color:#ff0000;" id="labelOtherLoc" for="expOtherLoc">${expense.label.OtherLocation} :</label>
     			 <input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
         </div>  
         <div ng-if="data.codeloga[0].code=='809' && data.codeloga[0].sys_id=='e8e4b084db44149009b962a916961906' && data.items[0].expline_other_location==''">
           <label style="padding-top:8px;" id="labelReqValue" for="expReqValue">${expense.label.RequestedValue} :</label>
           <input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number">
           <label style="padding-top:8px;" id="labelLocFrom" for="location_from">${expense.label.LocationFrom} :</label>
           <sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" ></sn-record-picker>
           <label style="padding-top:8px;display:none;" id="labelLocTo" for="location_to">${expense.label.LocationTo} :</label>
           <sn-record-picker readonly style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" ></sn-record-picker>
      		 <label style="padding-top:8px;color:#ff0000;" id="labelOtherLoc" for="expOtherLoc">${expense.label.OtherLocation} :</label>
     			 <input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
         </div>  

         <!-- Affichage info Aller Simple : champ one_way -->
         <div ng-if="c.data.items[0].expline_one_way=='true'" style="padding-top:8px;">
           <input type="checkbox" disabled id="expOneway" class="type-boolean ng-binding ng-scope" checked>
           <label style="padding-left:8px;" id="labelOneway" for="expOneway">${expense.label.one_way}</label>
       	</div>  
         
         <div style="position:relative;" ng-if="data.codeloga[0].code!='79C' && data.codeloga[0].code!='809' && !1==1">
      		<label style="padding-top:8px;" id="labelOtherLoc" for="expOtherLoc">${expense.label.OtherLocation} :</label>
     			<input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text">
         </div>
         
         <!-- ************************************************* -->
       </td> 
       <td ng-if="data.CategRubric == 'Training'"class="thead text-nowrap" colspan=2>
        <div>
          <span class="clearfix"></span>
          <sp-widget widget="c.data.dataTableWidget"></sp-widget>
        </div>
         <!-- ************************************************* -->
       </td> 
   </table>

   <div>
    <table align="right" style="padding-top:20px; padding-right:0px;">
      <tr><td><span>&nbsp;</span></td></tr>
      <tr> 
       <td>
         <div class="panel-primary">
      	  <label for="close_expline"></label>
          <a id="close_expline" href="javascript:void(0)" ng-click="buttonClosewindow()" data-dismiss="modal" class="pull-right_expense panel panel-heading panel-primary" style="border-color: #a4282d; background-color: #b92d33;">
              ${expense.label.button_close}
          </a>
         </div>  
       </td>
       <td style="width:20px;">
       </td>
      </tr>
      <tr><td><span>&nbsp;</span></td></tr>
    </table>
   </div>
 </div>
</div>



]]></template>
    </sp_widget>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="HVS Expense Management">50e8c3d7dbea0090f5e2174b06961954</application>
        <comments/>
        <file_path/>
        <instance_id>3046dffd0a0a8c07003c444f428053a8</instance_id>
        <instance_name>vsdev</instance_name>
        <name>sp_widget_8e7e6b781b0505107f172f4aab4bcb49</name>
        <order/>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function(spModal, $scope, $rootScope, $location, $timeout, spUtil, spAriaFocusManager, $uibModalStack) {
  var c = this;
	
	$scope.expline_sysid = c.data.expline_sysid;
	$scope.valCodeloga = c.data.codeloga[0].code;
	
	var year= c.data.date.substr(6, 4);
	var month= c.data.date.substr(3, 2);
	var day= c.data.date.substr(0, 2);
	$scope.expDate = new Date(year,month-1,day);
	
	$scope.location_from = {
	displayValue: c.data.items[0].expline_location,
	value: c.data.LocationFromId,
	name: 'location_from'
	};
	
	$scope.location_to = {
	displayValue: c.data.items[0].expline_travelkm,
	value: c.data.LocationToId,
	name: 'location_to'
	};
	
	$scope.Rubric = {
	displayValue: c.data.items[0].expline_rubric,
	value: c.data.RubricId,
	name: 'Rubric'
	};
	
	$scope.expOpenBy = '' || c.data.items[0].expsheet_opened_by;
	$scope.expReqFor = '' || c.data.items[0].expsheet_requested_for;
	$scope.expContract = '' || c.data.items[0].expsheet_contract;
	$scope.expDesc = '' || c.data.items[0].expsheet_short_description;
	$scope.expAmount = parseFloat(c.data.items[1].expline_requested_amount).toFixed(2); //c.data.items[0].expline_requested_amount;
		
	if(''+c.data.items[0].expline_other_location_to == '') {
		$scope.expOtherLoc = '' || c.data.items[0].expline_location;
		$scope.expOtherLocTo = '' || c.data.items[0].expline_other_location;
	}
	else {
		$scope.expOtherLoc = '' || c.data.items[0].expline_other_location;
		$scope.expOtherLocTo = '' || c.data.items[0].expline_other_location_to;
	}
	
	$scope.CategDivers = '';
	if(c.data.items[0].expline_miscellaneous_account_code) {
		$scope.CategDivers = c.data.items[0].expline_miscellaneous_account_code;
	}
	c.data.CategDiversNbChar = $scope.CategDivers.trim().length;

	$scope.buttonClosewindow = function () {
				  $uibModalStack.dismissAll();
        };
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;.widget-data-table .clearfix{ 
	display: none; 
} 

.pointer {
    cursor: default;
}

.v5001b062d7101200b0b044580e6103eb .sp-list-cell {
    white-space: pre-wrap;
}

.user-profile-tabs { 
  height: 60px; 
   
  .widget-header { 
    padding-bottom: 10px; 
    font-weight: normal; 
    color : $brand-primary;
  } 
 
  .no-padding { 
    padding-left : 0px; 
    text-align: center; 
    cursor: pointer; 
 
  } 
 
  .tab-row { 
    margin-top: 15px; 
  } 
} 
 
.widget-tabs { 
  border-bottom: 1px solid $csm-border-color;
  margin-bottom: 15px; 
} 
.widget-tabs { 
  border-bottom: 1px solid $csm-border-color;
} 

.tr-top {
  border-top: 1px solid #ddd;
}

.th-exp-title {
    color: #b92d33;
    display: inline-block;
}

.td_img {
		width: 20px;
  	height: 20px;
  	display: inline-block;
}

.thead {
    border-bottom: 1px solid #ddd;
    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
    border-top: 1px solid #ddd;
}

h4 { 
  padding-left: 0px; 
  margin-bottom: 0px; 
} 
 
h4.selected-tab { 
  /*border-bottom: 2px solid #278EFC; */
  border-bottom: 2px solid $brand-primary; 
  color: $link-color;
} 

.btn_expense {
    display: inline-block;
    margin-bottom: 0;
    font-weight: normal;
    text-align: center;
    vertical-align: middle;
    touch-action: manipulation;
    cursor: pointer;
    background-image: none;
    border: 1px solid transparent;
    white-space: nowrap;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.42857;
    border-radius: 4px;
}

.pull-right_expense {
    float: right;
}

.btn_expense-primary_save {
    color: #ffffff;
    background-color: #5bb914;
    border-color: #508c23;
}
 
.btn_expense-primary_close {
    color: #ffffff;
    background-color: #b92d33;
    border-color: #a4282d;
}
 
.profile-tabs { 
  clear: both; 
  padding-bottom: 15px; 
} 

.td-alignmiddle {
	vertical-align:middle;
}
  
.panel-heading{
 background-color :  $panel-primary; 
}
.expense-panel-primary {
    border-color: #b92d33;
    width: 1585px;
}

.btn-padding-expense{
  padding-right: 15px; 
}

span.panel-title{
 color: $panel-default-heading-bg;
 /*vertical-align: sub;
  vertical-align: -webkit-baseline-middle;*/
}

.panel-heading &amp;gt; .dropdown .dropdown-toggle {
   color: $panel-primary-text;
   /*padding-bottom: 0px;
   vertical-align: bottom;*/
}

&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data&gt;{"options": {
	"sys_id": -1,
		"table": "incident"
	}
}&lt;/demo_data&gt;&lt;description/&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;hvs_expense_ticket_details&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link&gt;&lt;![CDATA[function(scope, elm) {
	// Set the focus back on the input for IE11
	scope.setFocus = function() {
		var input = $(elm[0]).find('textarea#post-input');
		if (input[0])
			input[0].focus();
	}
}]]&gt;&lt;/link&gt;&lt;name&gt;HVS Expense Ticket Details&lt;/name&gt;&lt;option_schema&gt;[{"hint":"Placeholder text shows selected journal field","name":"use_dynamic_placeholder","section":"Behavior","label":"Use dynamic placeholder","type":"boolean"},{"hint":"Message to show when record has no readable journal field","name":"no_readable_journal_field_message","default_value":"","section":"Presentation","label":"No readable journal field message","type":"string"},{"hint":"Enter key behavior is specified by system property (glide.service_portal.comment.enter_adds_newline) unless overridden here","name":"enter_key_behavior","section":"Behavior","default_value":"System property","label":"Enter key behavior","type":"choice","choices":[{"label":"System property","value":"System property"},{"label":"Submit","value":"Submit"},{"label":"New line","value":"New line"}]}]&lt;/option_schema&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
 // code for internal testing within Editor
 // input=[];
 // input.sys_id=['f0e523d01b632c107f172f4aab4bcb0b'];
 // end of code for internal testing
	
	var isApproverUser = false;
	var isApproverDelegate = false;
	var sUserDelegate = '';
	var user = new GlideRecord('sys_user');
	if(user.get(gs.getUserID())){
		isApproverUser = user.u_expense_approver;
	}
	
	var userDelegate = new GlideRecord('sys_user_delegate');
	userDelegate.addEncodedQuery("delegate="+gs.getUserID()+"^u_expense_approval=true");
	userDelegate.setLimit(1);
	userDelegate.query();
	while (userDelegate.next()) {
		isApproverDelegate = userDelegate.u_expense_approval;
		sUserDelegate =  userDelegate.user;
	}
	
	if(input) {
		if(input.sys_id) {
			data.valCodeloga='';
			data.items = getCatalogItems();
			data.expline_sysid = input.sys_id;
		}
	}

	var filterRubric = '';
	
	function getCatalogItems() {
		var sc = new GlideRecord('x_hdvi2_expense_view');
		sc.addQuery('expline_sys_id',input.sys_id);
		sc.query();
		var results = [];
		while (sc.next()) {
			if (!$sp.canReadRecord(sc) &amp;&amp; !isApproverDelegate &amp;&amp; !isApproverUser)
				continue;

			var ticketConversationOptions = {};
			ticketConversationOptions.sys_id = sc.getValue('expline_expense');
			ticketConversationOptions.table  = 'x_hdvi2_expense_sheet';
			ticketConversationOptions.record_id = sc.getValue('expline_expense');
			ticketConversationOptions.record_table  = 'x_hdvi2_expense_sheet';
			ticketConversationOptions.readonly = ''+input.read_only;
			ticketConversationOptions.record_only = ''+input.read_only;
			data.Attachment = $sp.getWidget('widget-expense-ticket-attachments', ticketConversationOptions);

			var options = {
				filter : 'expense='+sc.expsheet_sys_id+'^statusIN2,3,4^ORstatusIN1'
			};	
			
			data.dataTableWidget = $sp.getWidget('hvs-expense-widget-data-table', options);
			
			var item = {};
			// Récuperation des champs à afficher
			$sp.getRecordDisplayValues(item, sc, 'expline_sys_id,expsheet_contract,expsheet_number,expline_date_expense,expsheet_short_description,expsheet_opened_by,expsheet_requested_for,expsheet_contract,expline_rubric,expsheet_category,expline_status,expline_currency,expline_location,expline_travelkm,expline_other_location,expline_other_location_to,expsheet_category,expline_miscellaneous_account_code,expsheet_source,expline_one_way');
			results.push(item);
			// Récuperation des champs à afficher avec montant et valeur demandé
			$sp.getRecordValues(item, sc, 'expline_requested_amount,expline_requested_value');
			results.push(item);

			data.date=sc.getDisplayValue('expline_date_expense');
			data.expline_requested_value = parseFloat(sc.getValue('expline_requested_value'));
			data.expline_requested_amount = parseFloat(sc.getValue('expline_requested_amount'));
			
			// Récupération de l'expense type catégorie
			var sFilterRubric = sc.getValue('expsheet_category');
			data.CategRubric=sFilterRubric.charAt(0).toUpperCase() + sFilterRubric.slice(1);
			filterRubric ='category=topic^active=true^type='+sFilterRubric.charAt(0).toUpperCase() + sFilterRubric.slice(1)+'^contract_type=';
			data.areaRows = 2;
			if(data.CategRubric=='Training'){
				results[0].expsheet_short_description += "\n" + results[0].expsheet_source;
				data.areaRows = 4;
			}
			data.LocationFromId = ''||sc.getValue('expline_location');
			data.LocationToId = ''||sc.getValue('expline_travelkm');
			data.RubricId = ''||sc.getValue('expline_rubric');
		}

		data.codeloga = [];
		var scCodeLoga = new GlideRecord('x_hdvi2_expense_loga_data');
		scCodeLoga.addQuery('sys_id',data.RubricId);
		scCodeLoga.query();
		while (scCodeLoga.next()) {
			var objCode = {};
			data.valCodeloga=scCodeLoga.code;
			$sp.getRecordDisplayValues(objCode, scCodeLoga, 'code,label,sys_id');
			data.codeloga.push(objCode);
		}
		
		return results;
	}
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;h40009222&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2022-01-12 14:03:11&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;8e7e6b781b0505107f172f4aab4bcb49&lt;/sys_id&gt;&lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;&lt;sys_name&gt;HVS Expense Ticket Details&lt;/sys_name&gt;&lt;sys_package display_value="HVS Expense Management" source="x_hdvi2_expense"&gt;50e8c3d7dbea0090f5e2174b06961954&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="HVS Expense Management"&gt;50e8c3d7dbea0090f5e2174b06961954&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_8e7e6b781b0505107f172f4aab4bcb49&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;h40009222&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2022-01-12 14:27:53&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[ &lt;div ng-if="data.uId != 'user_id8a21e682dbb6ff80bbe25c88f4961984'"&gt;
 		&lt;sp-widget widget="c.data.Attachment" /&gt;
 &lt;/div&gt;
&lt;div class="panel panel-primary" &gt;

 &lt;div class="panel-heading"&gt;${expense.label.view_detail} : &lt;b&gt;{{c.data.items[0].expsheet_number}}&lt;/b&gt;&lt;/div&gt;
 &lt;div class="panel-primary"&gt;

   &lt;table class="table table-striped table-responsive"&gt;
     &lt;tr&gt;
       &lt;td class="thead text-nowrap"&gt;
      	&lt;label&gt;${expense.label.opened_by} :&lt;/label&gt;
     		&lt;input readonly class="form-control" ng-change="SetChangeTrue()" ng-model="expOpenBy" value="{{c.data.items[0].expsheet_expOpenBy}}" type="text"&gt;
       &lt;/td&gt;
      &lt;td class="thead text-nowrap"&gt;
     		&lt;label for="expReqFor"&gt;${expense.label.requested_for} :&lt;/label&gt;
     		&lt;input readonly class="form-control" ng-change="SetChangeTrue()" ng-model="expReqFor" value="{{c.data.items[0].expsheet_requested_for}}" type="text"&gt;
       &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
       &lt;td class="thead text-nowrap" colspan="2"&gt;
      	&lt;label for="expContract"&gt;${expense.label.Contract} :&lt;/label&gt;
     		&lt;input readonly class="form-control" ng-change="SetChangeTrue()" ng-model="expContract" value="{{c.data.items[0].expsheet_contract}}" type="text"&gt;
       &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
       &lt;td class="thead text-nowrap" colspan="2"&gt;
         &lt;label for="expDesc"&gt;${expense.label.short_description} :&lt;/label&gt;
         &lt;textarea readonly rows="{{c.data.areaRows}}" ng-bind-html="expDesc" id="expDesc" class="form-control" ng-change="SetChangeTrue()" ng-model="expDesc" type="text"&gt;&lt;/textarea&gt;
       &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr  ng-if="data.CategRubric == 'Standard'"&gt;
       &lt;td class="thead text-nowrap" colspan="2"&gt;
        &lt;label for="expDate"&gt;${expense.label.date} : &lt;/label&gt;
     		&lt;input readonly class="form-control" placeholder="dd-MM-yyyy" ng-change="SetChangeTrue()" ng-model="expDate" Value="{{data.date}}" id="expDate" type="date"&gt; 
       &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
       &lt;td ng-if="data.CategRubric == 'Standard'" class="thead text-nowrap" colspan=2&gt;
         &lt;div ng-if="data.CategRubric == 'Standard'"&gt;
           &lt;label for="Rubric"&gt;${expense.label.LogaRubric} :&lt;/label&gt;
           &lt;sn-record-picker readonly field="Rubric" table="'x_hdvi2_expense_loga_data'" display-field="'label'" value-field="'sys_id'" search-fields="'label'" page-size="" default-query="'{{c.data.FilterRubric}}'"&gt;&lt;/sn-record-picker&gt;
         &lt;/div&gt;
         &lt;!-- display selected category if Loga Rubric = Divers --&gt;
         &lt;div ng-if="data.items[0].expline_miscellaneous_account_code != ''  &amp;&amp; data.CategDiversNbChar &gt; 1"&gt;
           &lt;!--label for="CategDivers"&gt;${expense.label.CategoryDivers} :&lt;/label--&gt;
           &lt;input readonly class="form-control" ng-model="CategDivers" Value="{{c.data.items[0].expsheet_short_description}}" id="CategDivers" type="text"&gt;
         &lt;/div&gt;
         &lt;div ng-if="data.codeloga[0].code!='79C' || data.codeloga[0].code!='809'"&gt;
           &lt;label style="padding-top:8px;" id="labelReqAmount" for="expReqAmount"&gt;${expense.label.RequestedAmount} :&lt;/label&gt;
           &lt;input readonly id="expReqAmount" class="form-control" ng-change="SetChangeTrue()" ng-model="expAmount" value="{{c.data.items[1].expline_requested_amount}}" type="text"&gt;
         &lt;/div&gt;
         &lt;div ng-if="data.codeloga[0].code=='79C' &amp;&amp; data.codeloga[0].sys_id=='fbc37b13dbee0090f5e2174b06961948'"&gt;
           &lt;label style="padding-top:8px;" id="labelReqValue" for="expReqValue"&gt;${expense.label.RequestedValue} :&lt;/label&gt;
           &lt;input id="expReqValue" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number"&gt;
           &lt;label style="padding-top:8px;" id="labelLocFrom" for="location_from"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
           &lt;sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
           &lt;label style="padding-top:8px;" id="labelLocTo" for="location_to"&gt;${expense.label.LocationTo} :&lt;/label&gt;
           &lt;sn-record-picker readonly id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
      		 &lt;label style="padding-top:8px;display:none;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.OtherLocation} :&lt;/label&gt;
     			 &lt;input style="display:none;" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
         &lt;/div&gt; 
         &lt;div ng-if="data.codeloga[0].code=='809' &amp;&amp; data.codeloga[0].sys_id=='9805f444db44149009b962a916961908'"&gt;
           &lt;label style="padding-top:8px;" id="labelReqValue" for="expReqValue"&gt;${expense.label.RequestedValue} :&lt;/label&gt;
           &lt;input id="expReqValue" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number"&gt;
           &lt;label style="padding-top:8px;" id="labelLocFrom" for="location_from"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
           &lt;sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
           &lt;label style="padding-top:8px;" id="labelLocTo" for="location_to"&gt;${expense.label.LocationTo} :&lt;/label&gt;
           &lt;sn-record-picker readonly id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
      		 &lt;label style="padding-top:8px;display:none;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.OtherLocation} :&lt;/label&gt;
     			 &lt;input style="display:none;" readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
         &lt;/div&gt;  

         &lt;div ng-if="data.codeloga[0].code=='79C' &amp;&amp; data.codeloga[0].sys_id=='edc49704dbd3c050f5e2174b06961901' &amp;&amp; data.items[0].expline_other_location!=''"&gt;
           &lt;label style="padding-top:8px;" id="labelReqValue" for="expReqValue"&gt;${expense.label.RequestedValue} :&lt;/label&gt;
           &lt;input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number"&gt;
           &lt;!--label style="padding-top:8px;" id="labelLocFrom" for="location_from"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
           &lt;sn-record-picker id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
						--&gt;
      		 &lt;label style="padding-top:8px;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
     			 &lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
           &lt;label style="padding-top:8px;" id="labelOtherLocTo" for="expOtherLocTo"&gt;${expense.label.LocationTo} :&lt;/label&gt;
     			 &lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLocTo" ng-model="expOtherLocTo" value="{{c.data.items[0].other_location_to}}" type="text"&gt;
           &lt;!--sn-record-picker style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
					--&gt;
         &lt;/div&gt;  
         &lt;div ng-if="data.codeloga[0].code=='809' &amp;&amp; data.codeloga[0].sys_id=='e8e4b084db44149009b962a916961906' &amp;&amp; data.items[0].expline_other_location!=''"&gt;
           &lt;label style="padding-top:8px;" id="labelReqValue" for="expReqValue"&gt;${expense.label.RequestedValue} :&lt;/label&gt;
           &lt;input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number"&gt;
           &lt;!--label style="padding-top:8px;" id="labelLocFrom" for="location_from"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
           &lt;sn-record-picker id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
						--&gt;
      		 &lt;label style="padding-top:8px;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
     			 &lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
           &lt;label style="padding-top:8px;" id="labelOtherLocTo" for="expOtherLocTo"&gt;${expense.label.LocationTo} :&lt;/label&gt;
     			 &lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLocTo" ng-model="expOtherLocTo" value="{{c.data.items[0].other_location_to}}" type="text"&gt;
           &lt;!--sn-record-picker style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
					--&gt;
         &lt;/div&gt;  
                
         &lt;div ng-if="data.codeloga[0].code=='79C' &amp;&amp; data.codeloga[0].sys_id=='edc49704dbd3c050f5e2174b06961901' &amp;&amp; data.items[0].expline_other_location==''"&gt;
           &lt;label style="padding-top:8px;" id="labelReqValue" for="expReqValue"&gt;${expense.label.RequestedValue} :&lt;/label&gt;
           &lt;input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number"&gt;
           &lt;label style="padding-top:8px;" id="labelLocFrom" for="location_from"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
           &lt;sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
           &lt;label style="padding-top:8px;display:none;" id="labelLocTo" for="location_to"&gt;${expense.label.LocationTo} :&lt;/label&gt;
           &lt;sn-record-picker readonly style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
      		 &lt;label style="padding-top:8px;color:#ff0000;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.OtherLocation} :&lt;/label&gt;
     			 &lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
         &lt;/div&gt;  
         &lt;div ng-if="data.codeloga[0].code=='809' &amp;&amp; data.codeloga[0].sys_id=='e8e4b084db44149009b962a916961906' &amp;&amp; data.items[0].expline_other_location==''"&gt;
           &lt;label style="padding-top:8px;" id="labelReqValue" for="expReqValue"&gt;${expense.label.RequestedValue} :&lt;/label&gt;
           &lt;input readonly id="expReqValue" class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" ng-model="expValue" value="{{data.expline_requested_value}}" type="number"&gt;
           &lt;label style="padding-top:8px;" id="labelLocFrom" for="location_from"&gt;${expense.label.LocationFrom} :&lt;/label&gt;
           &lt;sn-record-picker readonly id="location_from" field="location_from" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'locations'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
           &lt;label style="padding-top:8px;display:none;" id="labelLocTo" for="location_to"&gt;${expense.label.LocationTo} :&lt;/label&gt;
           &lt;sn-record-picker readonly style="display:none;" id="location_to" field="location_to" table="'x_hdvi2_expense_expense_travel_km'" display-field="'locations'" value-field="'sys_id'" search-fields="'to'" page-size="15" default-query="'km=0'" &gt;&lt;/sn-record-picker&gt;
      		 &lt;label style="padding-top:8px;color:#ff0000;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.OtherLocation} :&lt;/label&gt;
     			 &lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
         &lt;/div&gt;  

         &lt;!-- Affichage info Aller Simple : champ one_way --&gt;
         &lt;div ng-if="c.data.items[0].expline_one_way=='true'" style="padding-top:8px;"&gt;
           &lt;input type="checkbox" disabled id="expOneway" class="type-boolean ng-binding ng-scope" checked&gt;
           &lt;label style="padding-left:8px;" id="labelOneway" for="expOneway"&gt;${expense.label.one_way}&lt;/label&gt;
       	&lt;/div&gt;  
         
         &lt;div style="position:relative;" ng-if="data.codeloga[0].code!='79C' &amp;&amp; data.codeloga[0].code!='809' &amp;&amp; !1==1"&gt;
      		&lt;label style="padding-top:8px;" id="labelOtherLoc" for="expOtherLoc"&gt;${expense.label.OtherLocation} :&lt;/label&gt;
     			&lt;input readonly class="form-control ng-binding ng-scope" ng-change="SetChangeTrue()" id= "expOtherLoc" ng-model="expOtherLoc" value="{{c.data.items[0].other_location}}" type="text"&gt;
         &lt;/div&gt;
         
         &lt;!-- ************************************************* --&gt;
       &lt;/td&gt; 
       &lt;td ng-if="data.CategRubric == 'Training'"class="thead text-nowrap" colspan=2&gt;
        &lt;div&gt;
          &lt;span class="clearfix"&gt;&lt;/span&gt;
          &lt;sp-widget widget="c.data.dataTableWidget"&gt;&lt;/sp-widget&gt;
        &lt;/div&gt;
         &lt;!-- ************************************************* --&gt;
       &lt;/td&gt; 
   &lt;/table&gt;

   &lt;div&gt;
    &lt;table align="right" style="padding-top:20px; padding-right:0px;"&gt;
      &lt;tr&gt;&lt;td&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;tr&gt; 
       &lt;td&gt;
         &lt;div class="panel-primary"&gt;
      	  &lt;label for="close_expline"&gt;&lt;/label&gt;
          &lt;a id="close_expline" href="javascript:void(0)" ng-click="buttonClosewindow()" data-dismiss="modal" class="pull-right_expense panel panel-heading panel-primary" style="border-color: #a4282d; background-color: #b92d33;"&gt;
              ${expense.label.button_close}
          &lt;/a&gt;
         &lt;/div&gt;  
       &lt;/td&gt;
       &lt;td style="width:20px;"&gt;
       &lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;&lt;td&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
    &lt;/table&gt;
   &lt;/div&gt;
 &lt;/div&gt;
&lt;/div&gt;



]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-544716399</payload_hash>
        <record_name>HVS Expense Ticket Details</record_name>
        <reverted_from/>
        <source>ac2a16e21bf48994e63a41588b4bcb06</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2022-01-12 14:27:54</sys_created_on>
        <sys_id>37143b301b4505107f172f4aab4bcbea</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>17e4eb026720000001</sys_recorded_at>
        <sys_updated_by>h40009222</sys_updated_by>
        <sys_updated_on>2022-01-12 14:27:54</sys_updated_on>
        <type>Widget</type>
        <update_guid>3f14f730e3450510ab0678174d441a73</update_guid>
        <update_guid_history>3f14f730e3450510ab0678174d441a73:-544716399,b0bea3b8620505102da795cff8174310:-1209376805,4e7e6b78650505107f33998e7c683e4b:2022851730</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="Record deleted 12.01.2022 15:46:26">e358bf341b4505107f172f4aab4bcb31</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2022-01-12 14:46:26</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_db_object display_value="" name="sp_widget">sp_widget</sys_db_object>
        <sys_id>d5b4b5ea0f9b46a8a7eb37ac648829d1</sys_id>
        <sys_metadata>8e7e6b781b0505107f172f4aab4bcb49</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>HVS Expense Ticket Details</sys_name>
        <sys_package display_value="HVS Expense Management" source="x_hdvi2_expense">50e8c3d7dbea0090f5e2174b06961954</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="HVS Expense Management">50e8c3d7dbea0090f5e2174b06961954</sys_scope>
        <sys_scope_delete display_value="">472e1ff3166d4450a148eb190542eac9</sys_scope_delete>
        <sys_update_name>sp_widget_8e7e6b781b0505107f172f4aab4bcb49</sys_update_name>
        <sys_update_version display_value="sp_widget_8e7e6b781b0505107f172f4aab4bcb49">37143b301b4505107f172f4aab4bcbea</sys_update_version>
        <sys_updated_by>h40009222</sys_updated_by>
        <sys_updated_on>2022-01-12 14:46:26</sys_updated_on>
    </sys_metadata_delete>
</record_update>
