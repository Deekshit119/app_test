<?xml version="1.0" encoding="UTF-8"?><record_update table="sc_cat_item_producer">
    <sc_cat_item_producer action="INSERT_OR_UPDATE">
        <access_type>restricted</access_type>
        <active>true</active>
        <allow_edit>false</allow_edit>
        <availability>on_both</availability>
        <billable>false</billable>
        <can_cancel>true</can_cancel>
        <category display_value="Salaires et finances">d163a722dbdfb700011e177e1696190a</category>
        <checked_out/>
        <cost>0</cost>
        <custom_cart/>
        <delivery_plan/>
        <delivery_plan_script/>
        <delivery_time>1970-01-03 00:00:00</delivery_time>
        <description><![CDATA[<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Les conditions pour que les demandes de formation puissent être sélectionnées pour un remboursement :</span></p>
<p><strong><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Sans redevance</span></strong></p>
<ul style="list-style-position: inside;"><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Total frais accordés supérieur à 0.-</span></li><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">La Demande de formation doit être Terminée (approuvée par le N&#43;1 et validée par le Service Formation)</span></li><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">La Demande de formation ne doit pas avoir été mise comme &#34;Remboursée&#34;</span></li></ul>
<p style="font-size: 10pt;"><strong><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Avec redevance</span></strong></p>
<ul style="list-style-position: inside;"><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Le Contrat doit avoir été retourné signé au Service Formation</span></li><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Total frais accordés supérieur à 0.-</span></li><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">La Demande de formation doit être Terminée (approuvée par le N&#43;1 et validée par le Service Formation)</span></li><li style="font-size: 10pt;"><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">La Demande de formation ne doit pas avoir été mise comme &#34;Remboursée&#34;</span></li></ul>]]></description>
        <display_price_property>non_zero</display_price_property>
        <entitlement_script/>
        <flow_designer_flow/>
        <group/>
        <hide_sp>false</hide_sp>
        <icon/>
        <ignore_price>true</ignore_price>
        <image/>
        <list_price>0</list_price>
        <location/>
        <mandatory_attachment>true</mandatory_attachment>
        <meta>Expense Line Frais Parking Hébergement Hôtel Hotel Train CFF Voiture Move Training Formation Remboursement Repas Billet formation Ausgaben Zeile Gebühren Parken Hosting Hotel Hotel Zug SBB Auto Reisen Verschieben Rückerstattung Mahlzeiten Ticket Ausbildung</meta>
        <mobile_hide_price>false</mobile_hide_price>
        <mobile_picture/>
        <mobile_picture_type>use_desktop_picture</mobile_picture_type>
        <model/>
        <name>Demande de remboursement - Formation</name>
        <no_attachment_v2>false</no_attachment_v2>
        <no_cart>false</no_cart>
        <no_cart_v2>false</no_cart_v2>
        <no_delivery_time_v2>false</no_delivery_time_v2>
        <no_order>false</no_order>
        <no_order_now>true</no_order_now>
        <no_proceed_checkout>false</no_proceed_checkout>
        <no_quantity>false</no_quantity>
        <no_quantity_v2>false</no_quantity_v2>
        <no_search>false</no_search>
        <no_wishlist_v2>false</no_wishlist_v2>
        <omit_price>false</omit_price>
        <order>0</order>
        <ordered_item_link/>
        <owner display_value="Virginie Bétrisey">3bf0606adbca6b800abb65925b961944</owner>
        <picture/>
        <post_insert_script/>
        <preview>JavaScript: popupOpenStandard("com.glideapp.servicecatalog_cat_item_view.do?v=1&amp;sysparm_id=34ba4400dbc38410011e177e16961944&amp;sysparm_preview=true", "summary");</preview>
        <price>0</price>
        <published_ref/>
        <recurring_frequency/>
        <recurring_price>0</recurring_price>
        <redirect_url>generated_record</redirect_url>
        <request_method/>
        <roles/>
        <save_options/>
        <save_script/>
        <sc_catalogs>e009c323ff031100a0a5ffffffffff37</sc_catalogs>
        <sc_ic_item_staging/>
        <sc_ic_version/>
        <sc_template/>
        <script><![CDATA[/*** --- Do not modify or remove this script !! --- Automatically added by "Add Predefined script" business rule. 
Forces population of this record producer sys_id into the target record***/
var rpId = "34ba4400dbc38410011e177e16961944";
current.u_cat_item = rpId;
/***------------------ ***/
if(!gs.isMobile()) {
	producer.portal_redirect = "exphvs";
}

current.opened_by = gs.getUserID();
current.contract = producer.contract;


var assignment_group = gs.getProperty('x_hdvi2_expense.salary_group.id');
current.assignment_group = assignment_group;
current.short_description = producer.training_description;
current.status = 1;
current.category = 'training';
current.source = producer.training_request;
current.source_table = "x_hdvi2_training_m_request";
if (producer.last_expense_for_this_training == "Yes" || producer.last_expense_for_this_training == "yes" || producer.last_expense_for_this_training == "Oui" || producer.last_expense_for_this_training == "oui") {
    current.last_expense_for_related_source = true;
}


var fTotalAmount = 0;

// Générer les lignes de dépenses

var variables = JSON.parse(producer.mvar_hvs_rff_expense_line_input);
for (idx = 0; idx < variables.length; idx++) {
    var gr_expLine = new GlideRecord("x_hdvi2_expense_line");
    gr_expLine.initialize();
    gr_expLine.expense = current.sys_id;
    gr_expLine.status = 0;
    if (producer.sr_doublon == 'Yes') gr_expLine.duplicated = true;
    else gr_expLine.duplicated = false;

    gr_expLine.currency = variables[idx].currency;
    gr_expLine.date_expense = variables[idx].expense_date;
    gr_expLine.requested_amount = parseFloat(variables[idx].amount_to_refund || '0');
    fTotalAmount = fTotalAmount + parseFloat(variables[idx].amount_to_refund || '0');
    gr_expLine.requested_value = parseFloat('0');
    gr_expLine.training_category = variables[idx].expense_line;

    //---------------
    //To get the LOGA rubric of each expline line based on the category, the contract and the royalty option
    var royalty = false;

	//The royalty option of the TREQ is only used for the traning fee category
    if (variables[idx].expense_line == "training_fee") {
        var gr_treq = new GlideRecord("x_hdvi2_training_m_request");
        if (gr_treq.get(producer.training_request)) {
            royalty = gr_treq.royalty;
        }
		
    }
	
	var rubrics_for_my_contract = new x_hdvi2_expense.HVSExpenseUserUtils().getLogaCategoriesBasedOnContract('training', producer.contract);

    var gr_loga_rubric = new GlideRecord("x_hdvi2_expense_loga_data");
    gr_loga_rubric.addEncodedQuery("training_category=" + variables[idx].expense_line + "^" + "limited_to_training_with_royalty=" + royalty + "^" + rubrics_for_my_contract);
    gr_loga_rubric.query();
    while (gr_loga_rubric.next()) {
		
        gr_expLine.rubric = gr_loga_rubric.sys_id;
    }

    //----------------------

    gr_expLine.description = variables[idx].training_description;

    // for storing selected category for rubrc = Divers
    var sDivers = ''; //producer.sr_miscellaneous_account_code.getDisplayValue() + '';
    if (sDivers != '')
        gr_expLine.miscellaneous_account_code = producer.sr_miscellaneous_account_code.getDisplayValue() + " | " + producer.sr_miscellaneous_account_code;
    else
        gr_expLine.miscellaneous_account_code = '';
    gr_expLine.insert();
}

current.total_requested_amount = fTotalAmount;]]></script>
        <short_description>Soumettre une demande de remboursement pour des frais de formation</short_description>
        <show_variable_help_on_load>false</show_variable_help_on_load>
        <start_closed>false</start_closed>
        <state/>
        <sys_class_name>sc_cat_item_producer</sys_class_name>
        <sys_created_by>h40000572</sys_created_by>
        <sys_created_on>2020-02-13 14:53:34</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>34ba4400dbc38410011e177e16961944</sys_id>
        <sys_mod_count>55</sys_mod_count>
        <sys_name>Demande de remboursement - Formation</sys_name>
        <sys_package display_value="HVS Expense Management" source="x_hdvi2_expense">50e8c3d7dbea0090f5e2174b06961954</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="HVS Expense Management">50e8c3d7dbea0090f5e2174b06961954</sys_scope>
        <sys_update_name>sc_cat_item_producer_34ba4400dbc38410011e177e16961944</sys_update_name>
        <sys_updated_by>h40000572</sys_updated_by>
        <sys_updated_on>2021-11-24 11:26:51</sys_updated_on>
        <table_name>x_hdvi2_expense_sheet</table_name>
        <taxonomy_topic/>
        <template/>
        <template_manager_roles/>
        <type>item</type>
        <u_account_h/>
        <u_delivery_time/>
        <u_fulfillment_group_list/>
        <u_keywords/>
        <u_opale_numbers/>
        <u_owner display_value="Virginie Bétrisey">3bf0606adbca6b800abb65925b961944</u_owner>
        <u_related_items/>
        <use_sc_layout>true</use_sc_layout>
        <vendor/>
        <view/>
        <visible_bundle>true</visible_bundle>
        <visible_guide>true</visible_guide>
        <visible_standalone>true</visible_standalone>
        <workflow/>
    </sc_cat_item_producer>
    <sys_translated_text action="delete_multiple" query="documentkey=34ba4400dbc38410011e177e16961944"/>
    <sys_translated_text action="INSERT_OR_UPDATE">
        <documentkey>34ba4400dbc38410011e177e16961944</documentkey>
        <fieldname>description</fieldname>
        <language>fr</language>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2021-08-27 10:38:03</sys_created_on>
        <sys_id>771410e01b1af4907f172f4aab4bcbbf</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_updated_by>h40000572</sys_updated_by>
        <sys_updated_on>2021-11-24 11:26:51</sys_updated_on>
        <tablename>sc_cat_item_producer</tablename>
        <value>&lt;p&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;Conditions pour que les Demandes de formation puissent &amp;ecirc;tre s&amp;eacute;lectionn&amp;eacute;es pour un remboursement :&lt;/span&gt;&lt;/p&gt;&#13;
&lt;p&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;&lt;strong&gt;Sans redevance&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&#13;
&lt;ul style="list-style-position: inside;"&gt;&#13;
&lt;li style="font-size: 10pt;"&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;Le Total des frais accord&amp;eacute;s est sup&amp;eacute;rieur &amp;agrave; 0.-&lt;/span&gt;&lt;/li&gt;&#13;
&lt;li style="font-size: 10pt;"&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;La Demande de formation doit &amp;ecirc;tre Termin&amp;eacute;e (approuv&amp;eacute;e par le N+1 et valid&amp;eacute;e par le Service Formation)&lt;/span&gt;&lt;/li&gt;&#13;
&lt;li style="font-size: 10pt;"&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;La Demande de formation ne doit pas avoir &amp;eacute;t&amp;eacute; mise comme "Rembours&amp;eacute;e"&lt;/span&gt;&lt;/li&gt;&#13;
&lt;/ul&gt;&#13;
&lt;p style="font-size: 10pt;"&gt;&lt;strong&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;Avec redevance&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&#13;
&lt;ul style="list-style-position: inside;"&gt;&#13;
&lt;li style="font-size: 10pt;"&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;Le Contrat doit avoir &amp;eacute;t&amp;eacute; retourn&amp;eacute; sign&amp;eacute; au Service Formation&lt;/span&gt;&lt;/li&gt;&#13;
&lt;li style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;Le Total des frais accord&amp;eacute;s est sup&amp;eacute;rieur &amp;agrave; 0.-&lt;/li&gt;&#13;
&lt;li style="font-size: 10pt;"&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;La Demande de formation doit &amp;ecirc;tre Termin&amp;eacute;e (approuv&amp;eacute;e par le N+1 et valid&amp;eacute;e par le Service Formation)&lt;/span&gt;&lt;/li&gt;&#13;
&lt;li style="font-size: 10pt;"&gt;&lt;span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"&gt;La Demande de formation ne doit pas avoir &amp;eacute;t&amp;eacute; mise comme "Rembours&amp;eacute;e"&lt;/span&gt;&lt;/li&gt;&#13;
&lt;/ul&gt;</value>
    </sys_translated_text>
    <sys_translated_text action="INSERT_OR_UPDATE">
        <documentkey>34ba4400dbc38410011e177e16961944</documentkey>
        <fieldname>name</fieldname>
        <language>fr</language>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2021-08-27 10:38:03</sys_created_on>
        <sys_id>3f1410e01b1af4907f172f4aab4bcbbb</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>h40009222</sys_updated_by>
        <sys_updated_on>2021-08-27 10:38:03</sys_updated_on>
        <tablename>sc_cat_item_producer</tablename>
        <value>Demande de remboursement - Formation</value>
    </sys_translated_text>
    <sys_translated_text action="INSERT_OR_UPDATE">
        <documentkey>34ba4400dbc38410011e177e16961944</documentkey>
        <fieldname>short_description</fieldname>
        <language>fr</language>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2021-08-27 10:38:03</sys_created_on>
        <sys_id>671410e01b1af4907f172f4aab4bcbb8</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>h40009222</sys_updated_by>
        <sys_updated_on>2021-08-27 10:38:03</sys_updated_on>
        <tablename>sc_cat_item_producer</tablename>
        <value>Soumettre une demande de remboursement pour des frais de formation</value>
    </sys_translated_text>
    <sys_translated_text action="INSERT_OR_UPDATE">
        <documentkey>34ba4400dbc38410011e177e16961944</documentkey>
        <fieldname>u_keywords</fieldname>
        <language>fr</language>
        <sys_created_by>h40009222</sys_created_by>
        <sys_created_on>2021-08-27 10:38:03</sys_created_on>
        <sys_id>e31410e01b1af4907f172f4aab4bcbb4</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>h40009222</sys_updated_by>
        <sys_updated_on>2021-08-27 10:38:03</sys_updated_on>
        <tablename>sc_cat_item_producer</tablename>
        <value/>
    </sys_translated_text>
    <fx_price action="delete_multiple" query="id=34ba4400dbc38410011e177e16961944"/>
    <fx_price action="INSERT_OR_UPDATE">
        <amount>0</amount>
        <currency display_value="CHF">CHF</currency>
        <field>price</field>
        <id>34ba4400dbc38410011e177e16961944</id>
        <parent/>
        <reference_amount>0</reference_amount>
        <reference_currency display_value="CHF">CHF</reference_currency>
        <sys_created_by>h40000572</sys_created_by>
        <sys_created_on>2020-02-13 14:53:35</sys_created_on>
        <sys_id>78ba4400dbc38410011e177e16961945</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>h40000572</sys_updated_by>
        <sys_updated_on>2020-02-13 14:53:35</sys_updated_on>
        <table>sc_cat_item_producer</table>
        <type>calculated</type>
    </fx_price>
    <fx_price action="INSERT_OR_UPDATE">
        <amount>0</amount>
        <currency display_value="CHF">CHF</currency>
        <field>recurring_price</field>
        <id>34ba4400dbc38410011e177e16961944</id>
        <parent/>
        <reference_amount>0</reference_amount>
        <reference_currency display_value="CHF">CHF</reference_currency>
        <sys_created_by>h40000572</sys_created_by>
        <sys_created_on>2020-02-13 14:53:35</sys_created_on>
        <sys_id>7cba4400dbc38410011e177e16961946</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>h40000572</sys_updated_by>
        <sys_updated_on>2020-02-13 14:53:35</sys_updated_on>
        <table>sc_cat_item_producer</table>
        <type>calculated</type>
    </fx_price>
</record_update>
